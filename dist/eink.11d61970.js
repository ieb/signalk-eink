parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"dJBi":[function(require,module,exports) {
try{var t=document.getElementById("debug");debug=function(){},t&&(debug=function(i){"string"==typeof i?t.value=t.value+"\n"+i:JSON?t.value=t.value+"\n"+JSON.stringify(i):t.value=t.value+"\n"+i})}catch(s){document.getElementById("debug").value=document.getElementById("debug").value+"\nFailed Fixes\n"+s}function i(t){isKindle}function e(t,i){for(var e in i.prototype)t.prototype[e]=i.prototype[e];t.prototype.constructor=t}isKindle=void 0===Object.create,debug("Kindle: "+isKindle),EInkDataStoreFactory=function(t){this.dataStores={}},EInkDataStoreFactory.prototype.getStore=function(t,i){return this.dataStores[i]||(void 0!==t.meta&&"rad"===t.meta.units?this.dataStores[i]=new EInkCircularStats:this.dataStores[i]=new EInkStats),this.dataStores[i]},EInkDrawingContext=function(t){this.dataStoreFactory=new EInkDataStoreFactory,this.canvas=t.canvas,this.themes=t.themes||{},this.displayList=t.displayList,this.displayPage=this.displayList[t.page||"default"],this.ctx=canvas.getContext("2d"),this.setTheme(t.theme||"default"),this.setOrientation(t.portrait,t.width||700,t.height||580)},EInkDrawingContext.prototype.setOrientation=function(t,i,e){this.width=i||this.width,this.height=e||this.height,t?(this.canvas.setAttribute("width",this.width+"px"),this.canvas.setAttribute("height",this.height+"px"),this.ctx.translate(10,10)):(this.canvas.setAttribute("width",this.height+"px"),this.canvas.setAttribute("height",this.width+"px"),this.ctx.rotate(-Math.PI/2),this.ctx.translate(10-this.width,10))},EInkDrawingContext.prototype.setPage=function(t){this.displayList[t]&&(this.displayPage=this.displayList[t],this.canvas.setAttribute("style","background-color:"+this.theme.background),this.ctx.clearRect(-10,-10,this.width+10,this.height+10))},EInkDrawingContext.prototype.setTheme=function(t){this.themeName!=t&&(this.theme=this.themes[t],this.themeName=t,this.canvas.setAttribute("style","background-color:"+this.theme.background),this.ctx.clearRect(-10,-10,this.width+10,this.height+10))},EInkDrawingContext.prototype.update=function(t){for(var i in this.displayList)for(var e=0;e<this.displayList[i].length;e++)this.displayList[i][e].update(t,this.dataStoreFactory);for(e=0;e<this.displayPage.length;e++)this.displayPage[e].render(this.ctx,t,this.theme,this.dataStoreFactory)},EInkUIController=function(t){this.drawingContext=t.context,this.rotateControl=t.rotateControl,this.pageControl=t.pageControl,this.themeControl=t.themeControl,this.pages=t.pages,this.themes=t.themes,this.rotation=!1,this.page=0,this.theme=0;var i=this;this.rotateControl&&this.rotateControl.addEventListener("click",function(t){i.rotation=!i.rotation,i.drawingContext.setOrientation(i.rotation),debug("Rotate Click")}),this.pageControl&&this.pageControl.addEventListener("click",function(t){i.page++,i.page===i.pages.length&&(i.page=0),i.drawingContext.setPage(i.pages[i.page]),debug("Page Click")}),this.themeControl&&this.themeControl.addEventListener("click",function(t){i.theme++,i.theme===i.themes.length&&(i.theme=0),i.drawingContext.setTheme(i.themes[i.theme]),debug(i.themes[i.theme])})},EInkUpdater=function(t){if(this.url=t.url,isKindle&&(this.url=this.url+"?k=1"),this.period=t.period,isKindle&&(this.period=Math.max(this.period,2e3)),this.calculations=t.calculations||{enhance:function(){}},this.context=t.context,XMLHttpRequest.DONE||(XMLHttpRequest.UNSENT=XMLHttpRequest.UNSENT||0,XMLHttpRequest.OPENED=XMLHttpRequest.OPENED||1,XMLHttpRequest.HEADERS_RECEIVED=XMLHttpRequest.HEADERS_RECEIVED||2,XMLHttpRequest.LOADING=XMLHttpRequest.LOADING||3,XMLHttpRequest.DONE=XMLHttpRequest.DONE||4),this.period){var i=this;debug(this.period),setInterval(function(){try{i.update()}catch(s){debug("error "+s)}},this.period)}},EInkUpdater.prototype.update=function(){var t=this,i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE&&200===i.status){var e=Date.now(),s=JSON.parse(i.responseText);s._ts=(new Date).getTime(),Calcs.prototype.save(s,"sys.updateTime",t.updateTime,new Date,"ms","Timetaken to process update",!0),t.calculations.enhance(s),t.context.update(s),t.updateTime=Date.now()-e}},i.open("GET",this.url),i.send()},EInkStats=function(t){this.withStats=!0,this._ts=0,this.currentValue=0,this.values=[],this.mean=0,this.max=0,this.min=0,this.stdev=0},EInkStats.prototype.doUpdate=function(t){return t._ts||(t._ts=(new Date).getTime()),this._ts!==t.ts&&(this._ts=t._ts,!0)},EInkStats.prototype.updateValues=function(t,i){if(this.doUpdate(i)&&(this.currentValue=t,this.withStats)){for(this.values.push(t);this.values.length>100;)this.values.shift();for(var e=0,s=0,a=0;a<this.values.length;a++)w=(a+1)/2,e+=this.values[a]*w,s+=w;this.mean=e/s,e=0,s=0;for(a=0;a<this.values.length;a++)w=(a+1)/2,e+=(this.values[a]-this.mean)*(this.values[a]-this.mean)*w,s+=w;this.stdev=Math.sqrt(e/s),this.min=this.mean,this.max=this.mean;for(a=this.values.length-1;a>=0;a--)this.min=Math.min(this.values[a],this.min);for(a=this.values.length-1;a>=0;a--)this.max=Math.max(this.values[a],this.max)}},EInkCircularStats=function(t){EInkStats.call(this,t),this.sinvalues=[],this.cosvalues=[]},e(EInkCircularStats,EInkStats),EInkCircularStats.prototype.updateValues=function(t,i){if(this.doUpdate(i)&&(this.currentValue=t,this.withStats)){for(this.values.push(t);this.values.length>100;)this.values.shift();for(this.sinvalues.push(Math.sin(t));this.sinvalues.length>100;)this.sinvalues.shift();for(this.cosvalues.push(Math.cos(t));this.cosvalues.length>100;)this.cosvalues.shift();for(var e=0,s=0,n=0,o=0;o<this.values.length;o++)w=(o+1)/2,e+=this.sinvalues[o]*w,s+=this.cosvalues[o]*w,n+=w;this.mean=Math.atan2(e/n,s/n),e=0,n=0;for(o=0;o<this.values.length;o++)w=(o+1)/2,a=this.values[o]-this.mean,a>Math.PI?a-=2*Math.PI:a<-Math.PI&&(a+=2*Math.PI),e+=a*a*w,n+=w;this.stdev=Math.sqrt(e/n),this.min=this.mean,this.max=this.mean;for(o=this.values.length-1;o>=0;o--)this.min=Math.min(this.values[o],this.min);for(o=this.values.length-1;o>=0;o--)this.max=Math.max(this.values[o],this.max)}},EInkTextBox=function(t){this.options=t,this.path=t.path,this.pathElements=t.path.split("."),this.boxSize=t.boxSize||100,this.labels=t.labels||{},this.x=t.x||0,this.y=t.y||0,this.displayUnits=t.displayUnits||"",this.displayPositive=t.displayPositive,this.displayNegative=t.displayNegative,this.withStats=void 0===t.withStats||t.withStats,this.scale=t.scale||1,this.precision=void 0===t.precision?1:t.precision,this.out="no data",this.data=void 0,this.withStats&&(this.outmean="-",this.outstdev="-",this.outmax="-",this.outmin="-")},EInkTextBox.prototype.resolve=function(t,i){var e=this.pathElements;i&&(e=i.split("."));for(var s=t,a=0;s&&a<e.length;a++)s=s[e[a]];return s},EInkTextBox.prototype.toDispay=function(t,i,e,s,a){var n=void 0===e?this.displayUnits:e,o=(s=void 0===s?this.displayNegative:s,a=void 0===a?this.displayPositive:a,t.toFixed(void 0===i?this.precision:i));return s&&o<0?o=s+(o=-o)+n:a&&o>0?o=a+o+n:o+=n,o},EInkTextBox.prototype.formatOutput=function(t,i,e){return i=i||this.scale,this.withStats?(this.out=this.toDispay(t.currentValue*i,e),this.outmax=this.toDispay(t.max*i,e),this.outmin=this.toDispay(t.min*i,e),this.outmean="μ "+this.toDispay(t.mean*i,e),this.outstdev="σ "+this.toDispay(t.stdev*i,e,this.displayUnits,"","")):this.out=this.toDispay(t.currentValue*i,e),this.out},EInkTextBox.prototype.startDraw=function(t,i){var e=this.boxSize,s=1.3*this.y*e,a=2.3*this.x*e,n=2.2*e,o=1.2*e;return t.translate(a,s),t.beginPath(),t.fillStyle=i.background,t.fillRect(0,0,n,o),t.strokeRect(0,0,n,o),t.fillStyle=i.foreground,t.strokeStyle=i.foreground,{t:s,l:a,w:n,h:o,sz:e}},EInkTextBox.prototype.endDraw=function(t,i){t.translate(-i.l,-i.t)},EInkTextBox.prototype.twoLineLeft=function(t,i,e,s){t.font=i.sz/3+"px arial",t.textBaseline="bottom",t.textAlign="left",t.fillText(e,.1*i.w,.2*i.h+i.sz/3),t.fillText(s,.1*i.w,.2*i.h+2*i.sz/3)},EInkTextBox.prototype.twoLineRight=function(t,i,e,s){t.font=i.sz/3+"px arial",t.textBaseline="bottom",t.textAlign="right",t.fillText(e,.95*i.w,.2*i.h+i.sz/3),t.fillText(s,.95*i.w,.2*i.h+2*i.sz/3)},EInkTextBox.prototype.baseLine=function(t,i,e,s){t.textBaseline="bottom",t.font=i.sz/4+"px arial",e&&(t.textAlign="left",t.fillText(e,.05*i.w,i.h)),s&&(t.textAlign="right",t.fillText(s,.95*i.w,i.h))},EInkTextBox.prototype.update=function(t,i){var e=this.resolve(t);e&&i.getStore(e,this.path).updateValues(e.value,t)},EInkTextBox.prototype.render=function(t,i,e,s){var a=this.resolve(i);if(a){var n=s.getStore(a,this.path);this.formatOutput(n)}var o=this.labels,h=this.startDraw(t,e);t.font=h.sz+"px arial",t.textBaseline="bottom",t.textAlign="center";var r=t.measureText(this.out).width;r>.8*h.w?(t.font=h.sz*(.8*h.w/r)+"px arial",t.fillText(this.out,.5*h.w,.9*h.h)):t.fillText(this.out,.5*h.w,h.h),o&&(t.font=h.sz/4+"px arial",t.textAlign="left",o.tl&&!this.withStats&&t.fillText(o.tl,.05*h.w,sz/4),o.bl&&t.fillText(o.bl,.05*h.w,h.h),t.textAlign="right",o.tr&&!this.withStats&&t.fillText(o.tr,.95*h.w,h.sz/4),o.br&&t.fillText(o.br,.95*h.w,h.h)),this.withStats&&(t.textAlign="left",t.fillText(this.outmin,.05*h.w,h.sz/4),t.textAlign="right",t.fillText(this.outmax,.95*h.w,h.sz/4),t.font=h.sz/8+"px arial",t.textAlign="center",t.fillText(this.outmean,.5*h.w,h.sz/8),t.fillText(this.outstdev,.5*h.w,h.sz/4)),this.endDraw(t,h)},EInkPilot=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:180/Math.PI,precision:0,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkPilot,EInkTextBox),EInkPilot.prototype.update=function(t,i){},EInkPilot.prototype.render=function(t,i,e,s){var a=this.resolve(i,"steering.autopilot.state");if(a){var n=a.value,o=this.resolve(i,"steering.autopilot.target.headingMagnetic"),h="-";o&&(h=this.formatOutput({currentValue:o.value}));var r=this.startDraw(t,e);t.font=r.sz+"px arial",t.textBaseline="bottom",t.textAlign="center",t.fillText(h,.5*r.w,r.h),this.baseLine(t,r,n,"deg"),t.textAlign="center",t.fillText("pilot",.5*r.w,r.sz/4),this.endDraw(t,r)}},EInkLog=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:1/1852,precision:1,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkLog,EInkTextBox),EInkLog.prototype.update=function(t,i){},EInkLog.prototype.render=function(t,i,e,s){var a=this.resolve(i,"navigation.trip.log"),n=this.resolve(i,"navigation.log");if(a||n){var o="0.0";a&&(o=this.formatOutput({currentValue:a.value},this.scale,2));var h="0.0";n&&(h=this.formatOutput({currentValue:n.value}));var r=this.startDraw(t,e);this.twoLineLeft(t,r,"t: "+o,"l: "+h),this.baseLine(t,r,"log","Nm"),this.endDraw(t,r)}},EInkFix=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:1/1852,precision:1,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkFix,EInkTextBox),EInkFix.prototype.update=function(t,i){},EInkFix.prototype.render=function(t,i,e,s){if(i&&i.navigation&&i.navigation.gnss){var a=i.navigation.gnss,n=a.methodQuality?a.methodQuality.value:"-",o=a.horizontalDilution?a.horizontalDilution.value:"-",h=a.type?a.type.value:"-",r=a.satellites?a.satellites.value:"-",l=(a.integrity&&a.integrity.value,this.startDraw(t,e));t.font=l.sz/6+"px arial",t.textBaseline="bottom",t.textAlign="left",t.fillText(n,.05*l.w,l.sz/4),t.fillText("sat:"+r,.05*l.w,2*l.sz/4),t.fillText("hdop:"+o,.05*l.w,3*l.sz/4),t.font=l.sz/6+"px arial",t.fillText(h,.05*l.w,l.sz),this.endDraw(t,l)}},EInkPossition=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:1,precision:1,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkPossition,EInkTextBox),EInkPossition.prototype.update=function(t,i){},EInkPossition.prototype.toLatitude=function(t){var i="N";t<0&&(t=-t,i="S");var e=Math.floor(t),s=(60*(t-e)).toFixed(3);return("00"+e).slice(-2)+"°"+("00"+s).slice(-6)+"′"+i},EInkPossition.prototype.toLongitude=function(t){var i="E";t<0&&(t=-t,i="W");var e=Math.floor(t),s=(60*(t-e)).toFixed(3);return("000"+e).slice(-3)+"°"+("00"+s).slice(-6)+"′"+i},EInkPossition.prototype.parseDate=function(t){var i;if(null!==(i=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(.*)Z/gm.exec(t))){var e=Math.floor(i[6]),s=i[6]-e;return new Date(Date.UTC(i[1],i[2]-1,i[3],i[4],i[5],e,s)).toUTCString()}return t},EInkPossition.prototype.render=function(t,i,e,s){var a="--°--.---′N",n="---°--.---′W",o="-";i&&i.navigation&&i.navigation.position&&i.navigation.position.value&&(a=this.toLatitude(i.navigation.position.value.latitude),n=this.toLongitude(i.navigation.position.value.longitude)),i&&i.navigation&&i.navigation.datetime&&i.navigation.datetime.value&&(o=this.parseDate(i.navigation.datetime.value));var h=this.startDraw(t,e);this.twoLineRight(t,h,a,n),t.font=h.sz/7+"px arial",t.fillText(o,.95*h.w,.95*h.h),this.endDraw(t,h)},EInkCurrent=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:1,precision:1,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkCurrent,EInkTextBox),EInkCurrent.prototype.update=function(t,i){},EInkCurrent.prototype.render=function(t,i,e,s){if(i&&i.environment&&i.environment.current){var a=this.formatOutput({currentValue:i.environment.current.value.drift},1.943844,1),n=this.formatOutput({currentValue:i.environment.current.value.setTrue},180/Math.PI,1),o=this.startDraw(t,e);this.twoLineLeft(t,o,a+" Kn",n+"°T"),this.baseLine(t,o,"current"),this.endDraw(t,o)}},EInkAttitude=function(t,i,e){var s={path:"none",x:t,y:i,withStats:!1,scale:180/Math.PI,precision:1,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkAttitude,EInkTextBox),EInkAttitude.prototype.update=function(t,i){},EInkAttitude.prototype.render=function(t,i,e,s){if(i&&i.navigation&&i.navigation.attitude){var a=i.navigation.attitude,n=this.formatOutput({currentValue:a.value.roll}),o=this.formatOutput({currentValue:a.value.pitch}),h=(this.formatOutput({currentValue:a.value.yaw}),this.startDraw(t,e));this.twoLineLeft(t,h,"roll:"+n+"°","pitch:"+o+"°"),this.baseLine(t,h,"attitude","deg"),this.endDraw(t,h)}},EInkRelativeAngle=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"deg"},x:e,y:s,withStats:!0,displayUnits:"°",displayNegative:"P",displayPositive:"S",textSize:3,scale:180/Math.PI,precision:null==n?0:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkRelativeAngle,EInkTextBox),EInkRelativeAngle.prototype.formatOutput=function(t,i,e){return i=i||this.scale,this.withStats?(this.out=this.toDispay(t.currentValue*i,e),this.outmax=this.toDispay(t.max*i,e),this.outmin=this.toDispay(t.min*i,e),this.outmean="μ "+this.toDispay(t.mean*i,e),this.outstdev="σ "+this.toDispay(t.stdev*i,1,this.displayUnits,"","")):this.out=this.toDispay(t.currentValue*i,e),this.out},EInkSpeed=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"kn"},x:e,y:s,withStats:!0,scale:1.943844,precision:null==n?1:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkSpeed,EInkTextBox),EInkDistance=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"m"},x:e,y:s,withStats:!0,scale:1,precision:null==n?1:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkDistance,EInkTextBox),EInkBearing=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"deg"},x:e,y:s,withStats:!0,scale:180/Math.PI,precision:null==n?0:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkBearing,EInkTextBox),EInkTemperature=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"C"},x:e,y:s,withStats:!0,scale:1,precision:null==n?1:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkTemperature,EInkTextBox),EInkTemperature.prototype.formatOutput=function(t){this.withStats?(this.out=this.toDispay(t.currentValue-273.15,this.precision),this.outmax=this.toDispay(t.max-273.15,this.precision),this.outmin=this.toDispay(t.min-273.15,this.precision),this.outmean="μ "+this.toDispay(t.mean-273.15,this.precision),this.outstdev="σ "+this.toDispay(t.stdev,this.precision)):this.out=this.toDispay(t.currentValue-273.15,this.precision)},EInkSys=function(t,i,e){var s={path:"none",labels:{bl:"sys"},x:t,y:i,withStats:!1,scale:1,precision:0,boxSize:e||100};EInkTextBox.call(this,s)},e(EInkSys,EInkTextBox),EInkSys.prototype.render=function(t,i,e,s){if(i&&i.sys){var a=i.sys,n=a.polarBuild?a.polarBuild.value:"-",o=a.calcTime?a.calcTime.value:"-",h=a.updateTime?a.updateTime.value:"-",r=(a.jsHeapSizeLimit&&(a.jsHeapSizeLimit.value/1048576).toFixed(1),a.totalJSHeapSize&&(a.totalJSHeapSize.value/1048576).toFixed(1),a.usedJSHeapSize?(a.usedJSHeapSize.value/1048576).toFixed(1):"-"),l=this.startDraw(t,e);t.font=l.sz/6+"px arial",t.textBaseline="bottom",t.textAlign="left",t.fillText("init: "+n,.05*l.w,l.sz/4),t.fillText("calc: "+o,.05*l.w,2*l.sz/4),t.fillText("up: "+h,.05*l.w,3*l.sz/4),t.fillText("mem: "+r,.05*l.w,4*l.sz/4),this.endDraw(t,l)}},EInkRatio=function(t,i,e,s,a,n){var o={path:t,labels:{bl:i,br:"%"},x:e,y:s,withStats:!0,scale:100,precision:null==n?0:n,boxSize:a||100};EInkTextBox.call(this,o)},e(EInkRatio,EInkTextBox),EInkRatio.prototype.formatOutput=function(t,i,e){return i=i||this.scale,this.withStats?(this.out=this.toDispay(t.currentValue*i,e),this.outmax=this.toDispay(t.max*i,e),this.outmin=this.toDispay(t.min*i,e),this.outmean="μ "+this.toDispay(t.mean*i,e),this.outstdev="σ "+this.toDispay(t.stdev*i,1,this.displayUnits,"","")):this.out=this.toDispay(t.currentValue*i,e),this.out};
},{}]},{},["dJBi"], null)
//# sourceMappingURL=eink.11d61970.js.map